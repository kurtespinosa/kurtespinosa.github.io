<!DOCTYPE html>
<html lang="en">

  <head>

  <!-- Common metas -->
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>
  K-fold Cross Validation in Neural Networks | Home
  
  </title>

  <!-- SEO metas -->
  <meta name="description" content="What is the correct way of implement K-fold cross validation in neural networks?">
  <link rel="canonical" href="http://kurtespinosa.com/2016/kfold/">
  <link rel="alternate" type="application/rss+xml" title="Home" href="http://kurtespinosa.com/feed.xml">

  <link href="https://fonts.googleapis.com/css?family=Lato:400,700|Lora:400,400i,700" rel="stylesheet">

  <!-- Favicons -->
  <link rel="apple-touch-icon" href="/assets/img/apple-touch-icon.png">
  <link rel="shortcut icon" href="/assets/img/favicon.ico">

  <!-- CSS files -->
  <link rel="stylesheet" href="/assets/css/main.css">

</head>


  <body>

    <div class="site">

      <header class="site-header">

  <h1 class="site-title">
    <a href="/" title="Home page"><img class="site-logo" src="/assets/img/me.png"></a>
  </h1>

  <nav class="site-nav">
    
      
      
    <a href="/blog/"   title="Stuffs I write about" >Blog</a>
    
      
      
    <a href="/projects/"   title="Stuffs I like to do" >Projects</a>
    
      
      
    <a href="/research/"   title="Stuffs I seriously do" >Research</a>
    
      
      
    <a href="/about/"   title="Learn about me" >About</a>
    
  </nav>

</header>
<!-- site-header -->


      <div class="site-content">
        <article class="post">

  <header class="post-header">
    <h1 class="post-title">K-fold Cross Validation in Neural Networks</h1>
    <time class="post-date" datetime="2016-08-20 00:00:00 +0100">
    
    
    Aug.
      
    20th
    2016
    </time>
  </header>

  <div class="post-content pretty-links">
    <p>What I want to explain here is how to use K-fold cross validation in neural networks. We know that in neural networks, we use the back propagation algorithm to adjust the weights or parameters of the neural network as many times until the error (i.e. the difference of the predicted output and expected output values) are small enough for us. I will call these set of parameters/weights in the neural network as simply model parameters.</p>

<p>Now, we have heard as well that K-fold cross validation can help determine the best model parameters, that is the set of model parameters that can generalise(i.e. perform well) on unseen data(e.g. held-out test set). So the question is: how can we use K-fold cross validation to do that?</p>

<p>For example, you were given tweets and the task is named entity recognition (NER). Each tweet has been tokenized and each token labeled with a particular entity type (e.g. location, person, organization, etc). So how do you proceed?</p>

<p>Using neural network, here’s how you should proceed:</p>
<ol>
  <li>Split the data into k-folds and each fold has train, dev, and test set.</li>
  <li>For each fold, within an epoch loop, train the neural network parameters with the training set and decide whether to continue training using the dev set. Finally at the end of every epoch, you can test the model performance by using the test set.</li>
  <li>Compute the final f-score using method 3 in this <a href="http://citeseerx.ist.psu.edu/viewdoc/download;jsessionid=DA673A6EA027C2E8B1831FD9B9A24A0C?doi=10.1.1.186.8880&amp;rep=rep1&amp;type=pdf">paper</a>.</li>
  <li>Retrain the whole dataset using the neural network param with the best f-score.</li>
  <li>That’s it! You have the model which can generalise to unseen examples.</li>
</ol>

<h2 id="references">References</h2>
<ol>
  <li><a href="http://cs229.stanford.edu/notes/cs229-notes5.pdf">http://cs229.stanford.edu/notes/cs229-notes5.pdf</a></li>
  <li><a href="http://citeseerx.ist.psu.edu/viewdoc/download;jsessionid=DA673A6EA027C2E8B1831FD9B9A24A0C?doi=10.1.1.186.8880&amp;rep=rep1&amp;type=pdf">http://citeseerx.ist.psu.edu/viewdoc/download;jsessionid=DA673A6EA027C2E8B1831FD9B9A24A0C?doi=10.1.1.186.8880&amp;rep=rep1&amp;type=pdf</a></li>
  <li><a href="https://jamesmccaffrey.wordpress.com/2013/10/25/k-fold-cross-validation-for-neural-networks/">https://jamesmccaffrey.wordpress.com/2013/10/25/k-fold-cross-validation-for-neural-networks/</a></li>
  <li><a href="http://artint.info/html/ArtInt_189.html">http://artint.info/html/ArtInt_189.html</a></li>
  <li><a href="https://www.quora.com/Why-do-we-have-separation-of-data-into-training-held-out-and-test-data">https://www.quora.com/Why-do-we-have-separation-of-data-into-training-held-out-and-test-data</a></li>
  <li><a href="https://stackoverflow.com/questions/2976452/whats-is-the-difference-between-train-validation-and-test-set-in-neural-networ">https://stackoverflow.com/questions/2976452/whats-is-the-difference-between-train-validation-and-test-set-in-neural-networ</a></li>
</ol>

<div id="disqus_thread"></div>
<script>
var disqus_config = function () {
this.page.url = "http://kurtespinosa.com/2016/kfold/"; // <--- use canonical URL
this.page.identifier = "/2016/kfold";
};
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');

s.src = '//kurtespinosa.disqus.com/embed.js'; // <--- use Disqus shortname

s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>

<noscript>
  <p>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>&lt;/noscript&gt;</p>

</noscript>

  </div>

  <em>Thank you for scrolling</em> <img src="/assets/img/wink.png" class="emoji left">

</article>

      </div>
      <!-- site-content -->

      <footer class="site-footer">

  <div class="site-copy">&copy; 2017<span class="site-author">Kurt Espinosa</span>

  <div class="site-contact">
      <ul>
      <!--
        
        <li><a href="mailto:kurtjunshean.espinosa@postgrad.manchester.ac.uk">Contact</a></li>
        
      -->
        
        <li><a target="_blank" rel="external" href="https://github.com/kurtespinosa">Github</a></li>
        

        
        <li><a target="_blank" rel="external" href="https://twitter.com/brevis_iunius">Twitter</a></li>
        
      </ul>
    </div>

  </div>

  <div class="site-links">
    <div class="site-contact">
      <ul>
      <!--
        
        <li><a href="mailto:kurtjunshean.espinosa@postgrad.manchester.ac.uk">Contact</a></li>
        
      
        
        <li><a target="_blank" rel="external" href="https://github.com/kurtespinosa">Github</a></li>
        

        
        <li><a target="_blank" rel="external" href="https://twitter.com/brevis_iunius">Twitter</a></li>
        
      </ul>
      -->
    </div>

    <!--<div class="site-source">
      <ul>
        <li><a target="_blank" href="https://github.com/kurtespinosa/kurtespinosa.github.io">Source</a></li>
      </ul>
    </div>-->
  </div>

</footer>
<!-- site-footer -->



<script src="/assets/js/main.js"></script>


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','/assets/js/analytics.js','ga');

  ga('create', 'UA-XXXXXXXX-X', 'auto');
  ga('send', 'pageview');
</script>



    </div>
    <script id="dsq-count-scr" src="//kurtespinosa.disqus.com/count.js" async></script>


  </body>

</html>
